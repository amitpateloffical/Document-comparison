{% extends "layout.html" %}

{% block title %} 
    Document Upload
{% endblock title %}

{% block body %}
    <div class="container mx-auto my-12 px-6">
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900">Upload Documents</h1>
            <p class="mt-2 text-lg text-gray-600">Select the type of documents you wish to upload, specify the number of attachments, and generate the upload fields.</p>
        </div>

        <form action="#" method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="bg-white shadow-lg rounded-lg p-8 border border-gray-200">
                <fieldset class="mb-6">
                    <legend class="text-lg font-medium text-gray-800">Select Attachment Type</legend>
                    <div class="flex gap-6 mt-4">
                        <label class="flex items-center">
                            <input type="radio" name="attachmentType" id="PDF" class="form-radio text-blue-600" checked onclick="toggleForms()">
                            <span class="ml-2 text-gray-700">PDF</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="attachmentType" id="Word" class="form-radio text-blue-600" onclick="toggleForms()">
                            <span class="ml-2 text-gray-700">Word Doc</span>
                        </label>
                    </div>
                </fieldset>

                <!-- Form container for dynamic content -->
                <div id="displayForm">
                    <!-- PDF Form -->
                    <div id="pdfForm" class="hidden">
                        <div class="flex gap-5 mb-6">
                            <div class="w-3/4">
                                <label for="rowsPDF" class="block text-sm font-medium text-gray-700">Number of PDF Documents</label>
                                <input type="number" name="rows" id="rowsPDF" class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50" placeholder="Enter number of attachments">
                            </div>
                            <div class="flex items-end">
                                <button type="button" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" onclick="generateRows('pdf')">Generate</button>
                            </div>
                        </div>
                        <div class="border rounded-lg p-4" id="fieldFormPDF">
                            <!-- Dynamic fields will be added here -->
                        </div>
                    </div>

                    <!-- Word/Doc Form -->
                    <div id="wordForm" class="hidden">
                        <div class="flex gap-5 mb-6">
                            <div class="w-3/4">
                                <label for="rowsWord" class="block text-sm font-medium text-gray-700">Number of Word Documents</label>
                                <input type="number" name="rows" id="rowsWord" class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50" placeholder="Enter number of attachments">
                            </div>
                            <div class="flex items-end">
                                <button type="button" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" onclick="generateRows('word')">Generate</button>
                            </div>
                        </div>
                        <div class="border rounded-lg p-4" id="fieldFormWord">
                            <!-- Dynamic fields will be added here -->
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <script>
        function toggleForms() {
            const isPDFSelected = document.getElementById('PDF').checked;
            const pdfForm = document.getElementById('pdfForm');
            const wordForm = document.getElementById('wordForm');
            
            if (isPDFSelected) {
                pdfForm.classList.remove('hidden');
                wordForm.classList.add('hidden');
            } else {
                pdfForm.classList.add('hidden');
                wordForm.classList.remove('hidden');
            }
        }

        function generateRows(type) {
            const numRows = document.getElementById(`rows${type.charAt(0).toUpperCase() + type.slice(1)}`).value;
            const form = document.getElementById(`fieldForm${type.charAt(0).toUpperCase() + type.slice(1)}`);
            form.innerHTML = ''; // Clear existing fields

            if (numRows <= 0) {
                return;
            }

            let html = '';

            for (let i = 1; i <= numRows; i++) {
                html += `<div class="mb-4">
                    <label for="${type}_attachment_${i}" class="block text-sm font-medium text-gray-700">Attachment ${i}</label>
                    <input type="file" required name="${type}_attachment_${i}" class="mt-1 block w-full border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50" id="${type}_attachment_${i}">
                </div>`;
            }

            html += `<div class="mt-4">
                <button type="submit" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">Perform Comparison</button>
            </div>`;

            form.innerHTML = html;
        }

        document.addEventListener('DOMContentLoaded', toggleForms);
    </script>

{% endblock body %}
